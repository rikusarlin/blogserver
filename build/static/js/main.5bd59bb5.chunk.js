(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{44:function(e,t,n){e.exports=n(75)},56:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);n(45),n(28),n(46);var r,a=n(0),c=n.n(a),o=n(17),l=n.n(o),u=n(5),s=n(1),i=n.n(s),m=n(2),f=(n(56),n(41)),p=n(26),d=n(12),b=n.n(d),g="/api/blogs",v={getAll:function(){var e=Object(m.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:"bearer ".concat(t)}},e.next=3,b.a.get(g,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(m.a)(i.a.mark((function e(t,n){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer ".concat(n)}},e.next=3,b.a.post(g,t,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),update:function(){var e=Object(m.a)(i.a.mark((function e(t,n){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer ".concat(n)}},e.next=3,b.a.put(g+"/"+t.id,t,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(m.a)(i.a.mark((function e(t,n){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer ".concat(n)}},e.next=3,b.a.delete(g+"/"+t,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),comment:function(){var e=Object(m.a)(i.a.mark((function e(t,n,r){var a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:"bearer ".concat(r)}},e.next=3,b.a.post(g+"/"+t+"/comments",n,a);case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(console.log("state before action in blogReducer: ",e),console.log("action in blogReducer",t),t.type){case"NEW_BLOG":return[].concat(Object(f.a)(e),[t.data]);case"LIKE_BLOG":case"COMMENT_BLOG":return e.map((function(e){return e.id!==t.data.id?e:t.data}));case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data}));case"FETCH_BLOGS":return t.data;case"EMPTY_BLOG_LIST":return null;default:return e}},h=n(11),y=n(77),w={fetchBlogs:function(e){return console.log("In blogReducer.fetchBlogs, token: ",e),function(){var t=Object(m.a)(i.a.mark((function t(n){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.getAll(e);case 2:r=t.sent,console.log("Blogs.length: ",r.length),n({type:"FETCH_BLOGS",data:r});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},O=Object(u.b)((function(e){return{blogs:e.blogs,user:e.user}}),w)((function(e){var t=e.user.token,n=e.fetchBlogs;if(Object(a.useEffect)((function(){n(t)}),[t,n]),null!==e.blogs){var r=e.blogs.sort((function(e,t){return t.likes-e.likes})).map((function(e){return c.a.createElement("tr",{key:e.id},c.a.createElement("td",null,c.a.createElement(h.b,{"data-cy":"blog-link",to:"/blogs/".concat(e.id)},e.title)))}));if(null!==e.user.user)return c.a.createElement(y.a,{striped:!0},c.a.createElement("tbody",null,r))}return c.a.createElement("div",null)})),k={type:"EMPTY",message:""},x=function(e,t){return function(){var n=Object(m.a)(i.a.mark((function n(r){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r(B(e,"INFO"));case 2:setTimeout((function(){r(N())}),1e3*t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},j=function(e,t){return function(){var n=Object(m.a)(i.a.mark((function n(r){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r(B(e,"ERROR"));case 2:setTimeout((function(){r(N())}),1e3*t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},N=function(){return{type:"HIDE",data:{}}},B=function(e,t){return{type:"SHOW",data:{message:e,type:t}}},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(console.log("state before action in notificationReducer: ",e),console.log("action in notificationReducer",t),t.type){case"SHOW":return e=t.data;case"HIDE":return e=k;default:return e}},I=n(20),R=function(e){var t=Object(a.useState)(""),n=Object(I.a)(t,2),r=n[0],c=n[1];return{type:e,value:r,onChange:function(e){c(e.target.value)},reset:function(){c("")}}},T=n(43),G=n(42),S=(r="reset",function(e){return e[r],Object(T.a)(e,[r].map(G.a))}),_=n(4),C={showInfo:x,showError:j,likeBlog:function(e,t){return function(){var n=Object(m.a)(i.a.mark((function n(r){var a,c;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=Object(p.a)(Object(p.a)({},e),{},{likes:e.likes+1}),n.next=3,v.update(a,t);case 3:c=n.sent,r({type:"LIKE_BLOG",data:c});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},deleteBlog:function(e,t){return function(){var n=Object(m.a)(i.a.mark((function n(r){var a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v.deleteBlog(e,t);case 2:a=n.sent,console.log("In deleteBlog (id ".concat(e,"), response: ").concat(a)),r({type:"DELETE_BLOG",data:e});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},commentBlog:function(e,t,n){return function(){var r=Object(m.a)(i.a.mark((function r(a){var c;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,v.comment(e,t,n);case 2:c=r.sent,a({type:"COMMENT_BLOG",data:c});case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}},A=Object(_.e)((function(e){var t=R("text");if(void 0===e.blog||null===e.blog)return c.a.createElement("div",null);var n=function(){var n=Object(m.a)(i.a.mark((function n(r){var a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r.preventDefault();try{a={comment:t.value},e.commentBlog(e.blog.id,a,e.user.token),t.reset(),e.showInfo("commented on blog '".concat(e.blog.title,"'"),3)}catch(c){console.log("exception: "+c),e.showError("error in commenting blog",3)}case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),r=function(){var t=Object(m.a)(i.a.mark((function t(n){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault();try{r={id:e.blog.id,title:e.blog.title,author:e.blog.author,url:e.blog.url,likes:e.blog.likes},e.likeBlog(r,e.user.token),e.showInfo("liked a blog",3)}catch(a){console.log("exception: "+a),e.showError("error in updating likes",3)}case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),a=function(){var t=Object(m.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{e.deleteBlog(e.blog.id,e.user.token),e.showInfo("blog deleted",3),e.history.push("/blogs")}catch(n){console.log("exception: "+n),e.showError("error in deleting blog",3)}case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),o=e.blog.comments.map((function(e){return c.a.createElement("li",{key:e},e)})),l=c.a.createElement("form",{onSubmit:n},c.a.createElement("div",{className:"form-group row"},c.a.createElement("input",Object.assign({className:"col-sm-3"},S(t))),c.a.createElement("button",{type:"submit",className:"btn btn-primary"},"add comment")));if(null!==e.user.username){var u=c.a.createElement("button",{className:"btn btn-danger",type:"button",onClick:function(){window.confirm("remove blog ".concat(e.blog.title," by ").concat(e.blog.author,"?"))&&a()}},"delete");e.user.username!==e.blog.user.username&&(u=c.a.createElement("div",null));var s=c.a.createElement("div",null,c.a.createElement("b",null,"Comments"),c.a.createElement("br",null),l,c.a.createElement("ul",null,o));return e.blog.comments.length<=0&&(s=c.a.createElement("div",null,c.a.createElement("b",null,"No comments yet"),l)),c.a.createElement("div",{className:"blog"},c.a.createElement("div",null,c.a.createElement("h2",null,e.blog.title," ",e.blog.author),c.a.createElement("a",{href:e.blog.url},e.blog.url)," ",c.a.createElement("br",null),c.a.createElement("form",{onSubmit:r},e.blog.likes," likes ",c.a.createElement("button",{className:"btn btn-primary","data-cy":"like",type:"submit"},"like"),c.a.createElement("br",null)),"added by ",e.blog.user.name,c.a.createElement("br",null),u,c.a.createElement("br",null),s))}})),F=Object(u.b)((function(e){return{user:e.user}}),C)(A),U={getAll:function(){var e=Object(m.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(console.log("state before action in userReducer: ",e),console.log("action in userReducer",t),t.type){case"FETCH_USERS":return t.data;default:return e}},H={fetchUsers:function(){return function(){var e=Object(m.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.getAll();case 2:n=e.sent,t({type:"FETCH_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},M=Object(u.b)((function(e){return{user:e.user,users:e.users}}),H)((function(e){var t=e.user.username,n=e.fetchUsers;if(Object(a.useEffect)((function(){n()}),[t,n]),null!==e.users){var r=e.users.sort((function(e,t){return t.name-e.name})).map((function(e){return c.a.createElement("tr",{key:e.id},c.a.createElement("td",{className:"col-sm-1"},c.a.createElement(h.b,{to:"/users/".concat(e.id)},e.name)),c.a.createElement("td",{className:"col-sm-2"},e.blogs.length))}));return null!==e.user.username?c.a.createElement(y.a,{striped:!0},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",{className:"col-sm-1"}),c.a.createElement("th",{className:"col-sm-2"},"blogs created"))),c.a.createElement("tbody",null,r)):c.a.createElement("div",null)}return c.a.createElement("div",null,"No users found")})),z=Object(_.e)((function(e){if(void 0===e.user)return e.history.push("/blogs"),c.a.createElement("div",null);var t=e.user.blogs.map((function(e){return c.a.createElement("tr",{key:e.id},c.a.createElement("td",null,e.title))}));return c.a.createElement("div",null,c.a.createElement("h2",null,e.user.name),c.a.createElement("h3",null,"added blogs"),c.a.createElement(y.a,{striped:!0},c.a.createElement("tbody",null,t)))})),P={login:function(){var e=Object(m.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},W={username:null,name:null,token:null},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(console.log("state before action in loginReducer: ",e),console.log("action in login Reducer",t),t.type){case"LOGIN":return t.data;case"LOGOUT":return W;default:return e}},J={login:function(e,t){return function(){var n=Object(m.a)(i.a.mark((function n(r){var a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,P.login({username:e,password:t});case 2:a=n.sent,r({type:"LOGIN",data:{username:a.username,name:a.name,token:a.token}});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},showInfo:x,showError:j},K=Object(_.e)((function(e){var t=R("text"),n=R("password"),r=function(){var r=Object(m.a)(i.a.mark((function r(a){var c,o;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a.preventDefault();try{c=t.value,o=n.value,e.login(c,o),t.reset(),n.reset(),e.showInfo("login successful",3),e.history.push("/blogs")}catch(l){console.log("exception: "+l),e.showError("wrong username or password",3)}case 2:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return c.a.createElement("div",null,c.a.createElement("h3",null,"Login"),c.a.createElement("form",{onSubmit:r},c.a.createElement("div",{className:"form-group row"},c.a.createElement("label",{htmlFor:"Username",className:"col-sm-1 col-form-label"},"Username"),c.a.createElement("div",{className:"col-sm-3"},c.a.createElement("input",Object.assign({className:"form-control","data-cy":"username"},S(t))))),c.a.createElement("div",{className:"form-group row"},c.a.createElement("label",{htmlFor:"Password",className:"col-sm-1 col-form-label"},"Password"),c.a.createElement("div",{className:"col-sm-3"},c.a.createElement("input",Object.assign({className:"form-control","data-cy":"password"},S(n))))),c.a.createElement("button",{type:"submit",className:"btn btn-primary","data-cy":"login"},"login")))})),V=Object(u.b)(null,J)(K),q=Object(u.b)((function(e){return console.log("Notification, current state: ",e),{notification:e.notification}}),null)((function(e){var t=e.notification;return null===t.message?c.a.createElement("div",null):"INFO"===t.type?c.a.createElement("div",{className:"info"},t.message):"ERROR"===t.type?c.a.createElement("div",{className:"error"},t.message):c.a.createElement("div",null,t.message)})),Q=c.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),r=Object(I.a)(n,2),o=r[0],l=r[1],u={display:o?"none":""},s={display:o?"":"none"},i=function(){l(!o)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),c.a.createElement("div",null,c.a.createElement("div",{style:u},c.a.createElement("button",{onClick:i,"data-cy":e.buttonLabel,className:"btn btn-primary"},e.buttonLabel)),c.a.createElement("div",{style:s},e.children,c.a.createElement("button",{onClick:i,className:"btn btn-primary"},"cancel")))})),X={createBlog:function(e,t){return function(){var n=Object(m.a)(i.a.mark((function n(r){var a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v.create(e,t);case 2:a=n.sent,r({type:"NEW_BLOG",data:a});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},showInfo:x,showError:j},Z=Object(u.b)((function(e){return{user:e.user}}),X)((function(e){var t=R("text"),n=R("text"),r=R("text"),a=c.a.createRef(),o=function(){var c=Object(m.a)(i.a.mark((function c(o){var l;return i.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:o.preventDefault();try{a.current.toggleVisibility(),l={title:t.value,author:n.value,url:r.value},e.createBlog(l,e.user.token),r.reset(),t.reset(),n.reset(),e.showInfo("added new blog",3)}catch(u){console.log("exception: "+u),e.showError("error in adding new blog",3)}case 2:case"end":return c.stop()}}),c)})));return function(e){return c.apply(this,arguments)}}();return c.a.createElement(Q,{buttonLabel:"new blog",ref:a},c.a.createElement("div",null,c.a.createElement("h3",null,"New blog"),c.a.createElement("form",{onSubmit:o},c.a.createElement("div",{className:"form-group row"},c.a.createElement("label",{htmlFor:"Title",className:"col-sm-1 col-form-label"},"Title"),c.a.createElement("input",Object.assign({className:"col-sm-5","data-cy":"title"},S(t)))),c.a.createElement("div",{className:"form-group row"},c.a.createElement("label",{htmlFor:"Author",className:"col-sm-1 col-form-label"},"Author"),c.a.createElement("input",Object.assign({className:"col-sm-5","data-cy":"author"},S(n)))),c.a.createElement("div",{className:"form-group row"},c.a.createElement("label",{htmlFor:"URL",className:"col-sm-1 col-form-label"},"URL"),c.a.createElement("input",Object.assign({className:"col-sm-5","data-cy":"url"},S(r)))),c.a.createElement("button",{type:"submit","data-cy":"create",className:"btn btn-primary"},"create"))))})),$={logout:function(){return function(){var e=Object(m.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"LOGOUT",data:W});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},showInfo:x,showError:j,emptyBlogList:function(){return function(){var e=Object(m.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"EMPTY_BLOG_LIST",data:null});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},ee=Object(u.b)((function(e){return{user:e.user,users:e.users,blogs:e.blogs}}),$)((function(e){var t=function(){var t=Object(m.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault();try{e.logout(),e.emptyBlogList(),e.showInfo("logout successful",3)}catch(r){console.log("exception: "+r),e.showError("error in logout",3)}case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return c.a.createElement("div",{className:"container"},c.a.createElement(h.a,null,null!==e.user.username?c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement("div",{className:"navbar navbar-expand-lg"},c.a.createElement("div",{className:"navbar-nav navbar-light bg-light"},c.a.createElement("div",{className:"nav-item"},c.a.createElement(h.b,{className:"nav-link",to:"/"},"blogs")),c.a.createElement("div",{className:"nav-item"},c.a.createElement(h.b,{className:"nav-link",to:"/users"},"users")),c.a.createElement("div",{className:"nav-item"},e.user.name," logged in ",c.a.createElement("button",{type:"button",onClick:t,className:"btn btn-primary my-2 my-sm-0"},"logout")))),c.a.createElement(q,null),c.a.createElement("div",null,c.a.createElement("h2",null,"Blog app")),c.a.createElement(_.a,{exact:!0,path:"/",render:function(){return c.a.createElement("div",null,c.a.createElement(Z,null),c.a.createElement(O,null))}}),c.a.createElement(_.a,{exact:!0,path:"/blogs",render:function(){return c.a.createElement("div",null,c.a.createElement(Z,null),c.a.createElement(O,null))}}),c.a.createElement(_.a,{exact:!0,path:"/users",render:function(){return c.a.createElement(M,null)}}),c.a.createElement(_.a,{exact:!0,path:"/users/:id",render:function(t){var n,r=t.match;return c.a.createElement(z,{user:(n=r.params.id,null!==e.user?e.users.find((function(e){return e.id===n})):null)})}}),c.a.createElement(_.a,{exact:!0,path:"/blogs/:id",render:function(t){var n,r=t.match;return c.a.createElement(F,{blog:(n=r.params.id,null!==e.blogs?e.blogs.find((function(e){return e.id===n})):null)})}}))):c.a.createElement("div",null,c.a.createElement("h2",null,"Blog app"),c.a.createElement(q,null),c.a.createElement(V,null))))})),te=n(14),ne=n(40),re=Object(te.c)({blogs:E,notification:L,user:Y,users:D}),ae=Object(te.d)(re,Object(te.a)(ne.a));l.a.render(c.a.createElement(u.a,{store:ae},c.a.createElement(ee,null)),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.5bd59bb5.chunk.js.map